!function(){var i=!1,e=/xyz/.test(function(){})?/\b_super\b/:/.*/,n=function(){};n.extend=function(t){function n(){!i&&this.ctor&&this.ctor.apply(this,arguments)}var s,o,r,a=this.prototype;i=!0,s=new this,i=!1;for(r in t)"statics"!=r&&(s[r]="function"==typeof t[r]&&"function"==typeof a[r]&&e.test(t[r])?function(t,i){return function(){var n,e=this._super;return this._super=a[t],n=i.apply(this,arguments),this._super=e,n}}(r,t[r]):t[r]);for(o in this)this.hasOwnProperty(o)&&"extend"!=o&&(n[o]=this[o]);if(n.prototype=s,t.statics)for(r in t.statics)t.statics.hasOwnProperty(r)&&(n[r]=t.statics[r],"ctor"==r&&n[r]());return n.prototype.constructor=n,n.extend=arguments.callee,n.implement=function(t){for(var i in t)s[i]=t[i]},n},function(){var t={};t.Main=n.extend({ctor:function(){t.Game.init()}}),t.Game=n.extend({statics:{init:function(){this.canvas=document.querySelector("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.ctx=this.canvas.getContext("2d"),this.btn=document.querySelector("#startBtn"),this.msgSpan=document.querySelector("#msg"),this.myBall=new t.Ball(100,100,5,this.ctx),this.clientRect=this.canvas.getBoundingClientRect(),this.smallBalls=[],this.timer=new t.Timer(this.ctx),this.gameOver=!0,this.initEvent(),this.loop=t.RAF.requestInterval(function(){t.Game.tick()},15),this.tickZoom()},tickZoom:function(){this.zoomLoop=t.RAF.requestInterval(function(){t.Game.myBall.r+=5},5e3)},createBalls:function(){for(var i=0;10>i;i++)this.smallBalls.push(new t.SmallBall(t.Util.random(0,this.width),t.Util.random(0,this.height),3,this.ctx))},initEvent:function(){this.canvas.addEventListener("mousemove",function(i){t.Game.myBall.x=i.clientX-t.Game.clientRect.left,t.Game.myBall.y=i.clientY-t.Game.clientRect.top},!1),this.btn.addEventListener("click",function(){t.Game.start()},!1)},start:function(){this.reset(),this.gameOver=!1,this.createBalls()},tick:function(){this.gameOver||(this.ctx.clearRect(0,0,this.width,this.height),this.myBall.tick(),t.Util.each(this.smallBalls,function(t){t.tick()}),this.timer.tick(),this.checkCollision())},checkCollision:function(){var i=new t.Vector2(this.myBall.x,this.myBall.y);t.Util.each(this.smallBalls,function(e){i.distanceToSquared(new t.Vector2(e.x,e.y))<Math.pow(t.Game.myBall.r+e.r,2)&&(t.Game.msgSpan.innerHTML="你坚持了"+t.Game.timer.value+"秒",t.Game.gameOver=!0)})},reset:function(){this.msgSpan.innerHTML="",this.smallBalls.length=0,this.myBall.r=5,this.timer.value=0,t.RAF.clearRequestInterval(this.zoomLoop),this.tickZoom()}}}),t.Ball=n.extend({ctor:function(t,i,e,n){this.x=t,this.y=i,this.r=e,this.ctx=n},render:function(){this.ctx.fillStyle="Black",this.ctx.beginPath(),this.ctx.arc(this.x,this.y,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},tick:function(){this.render()}}),t.Timer=n.extend({ctor:function(i){this.ctx=i,this.value=1;var e=this;t.RAF.requestInterval(function(){e.value++},1e3)},render:function(){this.ctx.fillStyle="Black",this.ctx.fillText(this.value,180,20),this.ctx.fill()},tick:function(){this.render()}}),t.RAF=n.extend({statics:{ctor:function(){window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),window.requestInterval=function(t,i){function a(){var s=(new Date).getTime(),o=s-e;o>=i&&(t.call(),e=(new Date).getTime()),n.value=requestAnimFrame(a)}if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setInterval(t,i);var e=(new Date).getTime(),n=new Object;return n.value=requestAnimFrame(a),n},window.clearRequestInterval=function(t){window.cancelAnimationFrame?window.cancelAnimationFrame(t.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(t.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(t.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(t.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(t.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(t.value):clearInterval(t)},this.requestInterval=requestInterval,this.clearRequestInterval=clearRequestInterval}}}),t.SmallBall=n.extend({ctor:function(i,e,n,a){this.x=i,this.y=e,this.r=n,this.vx=t.Util.random(-4,4),this.vy=t.Util.random(-4,4),this.ctx=a,this.color=t.Util.randomColor()},render:function(){this.ctx.fillStyle=this.color,this.ctx.beginPath(),this.ctx.arc(this.x,this.y,this.r,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},tick:function(){this.x+=this.vx,this.y+=this.vy,(this.x<this.r||this.x+this.r>this.ctx.canvas.width)&&(this.vx*=-1),(this.y<this.r||this.y+this.r>this.ctx.canvas.height)&&(this.vy*=-1),this.render()}}),t.Util=n.extend({statics:{randomColor:function(){var t=["FF6347","DA70D6","A020F0","7171C6","5F9EA0","008B00","00CDCD","8B475D","FF6A6A"];return"#"+t[Math.floor(Math.random()*t.length)]},each:function(t,i){for(var e=t.length-1;e>-1;e--){i(t[e])}},random:function(t,i){return t+Math.floor(Math.random()*(i-t+1))}}}),t.Vector2=n.extend({ctor:function(t,i){this.x=t||0,this.y=i||0},distanceToSquared:function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e}}),new t.Main}()}(this);